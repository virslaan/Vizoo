<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0, minimum-scale=1.0">
    <title>Vizoo - Homepage of All</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }


        html, body {
            height: auto;
            min-height: 100vh;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            overflow-y: auto;
        }

        body {
            font-family: 'Calibri Light', 'Calibri', 'Candara', 'Segoe UI', 'Segoe UI Light', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #141414;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
            color: #ffffff;
            transition: background 0.8s ease;
        }
        
        .bg-video-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
            pointer-events: none;
        }
        
        .bg-video {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            min-width: 100%;
            min-height: 100%;
            width: auto;
            height: auto;
            object-fit: cover;
            opacity: 0;
            transition: opacity 2s ease-in-out;
        }
        
        .bg-video.active {
            opacity: 0.5;
        }
        
        .bg-video.playing {
            opacity: 0.5;
        }
        
        body.search-animating {
            animation: searchColorCycle 1.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        @keyframes searchColorCycle {
            0% {
                background: #141414;
            }
            16.66% {
                background: linear-gradient(135deg, #ff6b35 0%, #141414 50%, #141414 100%);
            }
            33.33% {
                background: linear-gradient(135deg, #0096ff 0%, #141414 50%, #141414 100%);
            }
            50% {
                background: linear-gradient(135deg, #00ff88 0%, #141414 50%, #141414 100%);
            }
            66.66% {
                background: linear-gradient(135deg, #ff6b9d 0%, #141414 50%, #141414 100%);
            }
            83.33% {
                background: linear-gradient(135deg, #9d4edd 0%, #141414 50%, #141414 100%);
            }
            100% {
                background: #141414;
            }
        }

        /* Hide scrollbars but keep functionality */
        * {
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        *::-webkit-scrollbar {
            display: none;
        }

        /* Header - AURA Style */
        .header {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 16px 24px;
            background: transparent;
            border-bottom: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 9999;
            opacity: 0;
            animation: headerSlide 0.6s cubic-bezier(0.16, 1, 0.3, 1) 0s forwards;
            transition: all 0.8s cubic-bezier(0.16, 1, 0.3, 1);
            width: 100%;
            max-width: 800px;
            pointer-events: auto;
        }
        
        .header.search-active {
            top: 0 !important;
            left: 0 !important;
            transform: translate(0, 0) !important;
            justify-content: space-between;
            max-width: 100%;
            padding: 16px 24px;
            background: rgba(20, 20, 20, 0.98) !important;
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            z-index: 9999 !important;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.5);
            opacity: 1 !important;
            pointer-events: auto;
        }

        @keyframes headerSlide {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) translateY(-8px);
            }
            100% {
                opacity: 1;
                transform: translate(-50%, -50%) translateY(0);
            }
        }
        
        .header-search-input {
            position: relative;
            z-index: 10000;
        }


        .header-search {
            flex: 1;
            max-width: 100%;
            width: 100%;
            position: relative;
            transition: all 0.6s cubic-bezier(0.16, 1, 0.3, 1);
        }
        
        .header.search-active .header-search {
            max-width: 600px;
            margin: 0 24px;
        }

        .header-search-input {
            width: 100%;
            padding: 12px 50px 12px 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            font-size: 15px;
            font-family: inherit;
            background: rgba(255, 255, 255, 0.05);
            color: #ffffff;
            outline: none;
            transition: all 0.2s ease;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        .header-search-input:focus {
            border-color: #ff6b35;
            background: rgba(255, 255, 255, 0.1);
            box-shadow: 0 0 0 2px rgba(255, 107, 53, 0.2);
        }

        .header-search-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .header-search-icon {
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            width: 20px;
            height: 20px;
            color: rgba(255, 255, 255, 0.5);
            pointer-events: none;
        }

        .header-actions {
            display: none;
            gap: 8px;
            align-items: center;
        }
        
        .header.search-active .header-actions {
            display: flex;
        }

        .header-btn {
            padding: 6px 12px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            color: #ffffff;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 6px;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        .header-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
        }

        .header-btn-icon {
            width: 16px;
            height: 16px;
        }

        /* Recommendations Side Panel */
        .recommendations-panel {
            position: fixed;
            left: 0;
            top: 0;
            width: 320px;
            height: 100vh;
            background: rgba(20, 20, 20, 0.98);
            backdrop-filter: blur(20px);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 200;
            transform: translateX(-100%);
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            overflow-y: auto;
            padding: 80px 0 20px;
            box-shadow: 2px 0 8px rgba(0, 0, 0, 0.5);
        }

        .recommendations-panel.open {
            transform: translateX(0);
        }

        .recommendations-header {
            padding: 0 24px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 20px;
        }

        .recommendations-title {
            font-size: 18px;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 8px;
        }

        .recommendations-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: transparent;
            border: none;
            color: #666666;
            font-size: 24px;
            cursor: pointer;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            transition: all 0.2s;
        }

        .recommendations-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: transparent;
            border: none;
            color: rgba(255, 255, 255, 0.7);
            font-size: 24px;
            cursor: pointer;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            transition: all 0.2s;
        }

        .recommendations-close:hover {
            background: rgba(255, 255, 255, 0.1);
            color: #ffffff;
        }

        .recommendations-section {
            padding: 0 24px;
            margin-bottom: 32px;
        }

        .recommendations-section-title {
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 8px;
        }

        .recommendations-clear {
            border: none;
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.7);
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 10px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .recommendations-clear:hover {
            background: rgba(255, 255, 255, 0.2);
            color: #ffffff;
        }

        .recommendation-item {
            padding: 10px 12px;
            margin-bottom: 4px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            background: transparent;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
        }

        .recommendation-item:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .recommendation-item-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 2px;
            min-width: 0;
        }

        .recommendation-item-text {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.9);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .recommendation-item-time {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.4);
        }

        .recommendation-item-delete {
            width: 20px;
            height: 20px;
            padding: 0;
            background: transparent;
            border: none;
            color: rgba(255, 255, 255, 0.4);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            transition: all 0.2s;
            flex-shrink: 0;
        }

        .recommendation-item-delete:hover {
            background: rgba(255, 107, 53, 0.2);
            color: #ff6b35;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: visible;
            padding: 20px 60px 60px;
            max-width: 1600px;
            margin: 0 auto;
            width: 100%;
            transition: padding-left 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            z-index: 0;
            padding-top: 100px;
        }
        
        .main-content.has-results {
            padding-top: 80px;
        }

        .main-content.panel-open {
            padding-left: 380px;
        }

        /* Hero Section */
        .hero {
            text-align: center;
            padding: 60px 0;
            opacity: 1;
            position: relative;
            z-index: 1;
            margin-top: 80px;
        }
        
        .hero-title-empty {
            font-size: clamp(36px, 7vw, 64px);
            font-weight: 300;
            color: rgba(255, 255, 255, 0.9);
            margin-bottom: 24px;
            line-height: 1.3;
        }
        
        .hero-subtitle-empty {
            font-size: clamp(16px, 3vw, 22px);
            font-weight: 300;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 0;
            line-height: 1.6;
            opacity: 0;
        }
        
        .hero-subtitle-empty.typing {
            opacity: 1;
        }
        
        .typing-text::after {
            content: '|';
            color: rgba(255, 107, 53, 0.9);
            animation: blink 1s infinite;
            margin-left: 2px;
        }
        
        @keyframes blink {
            0%, 50% {
                opacity: 1;
            }
            51%, 100% {
                opacity: 0;
            }
        }
        
        .hero-cta {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 14px 28px;
            background: #ff6b35;
            border: none;
            border-radius: 8px;
            color: #ffffff;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.2s ease;
        }
        
        .hero-cta:hover {
            background: #ff8555;
        }

        @keyframes titleReveal {
            0% {
                opacity: 0;
                transform: translateY(15px) scale(0.95);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .hero-title {
            font-size: clamp(32px, 8vw, 64px);
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 16px;
            line-height: 1.1;
            opacity: 1;
        }
        
        .hero-title:not(.hero-title-empty) {
            display: none;
        }

        @keyframes titleReveal {
            0% {
                opacity: 0;
                transform: translateY(15px) scale(0.95);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .hero-subtitle {
            font-size: clamp(14px, 3vw, 18px);
            font-weight: 400;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 50px;
            opacity: 1;
        }

        @keyframes subtitleReveal {
            0% {
                opacity: 0;
                transform: translateY(10px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .mode-chips {
            display: flex;
            gap: 12px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 40px;
            position: relative;
            z-index: 1;
        }

        .mode-chip {
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            color: rgba(255, 255, 255, 0.8);
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 6px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        .mode-chip:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4);
        }

        .mode-chip.active {
            background: #ff6b35;
            border-color: #ff6b35;
            color: #ffffff;
            transition: all 0.6s ease;
        }
        
        body.search-animating .mode-chip.active {
            animation: chipColorCycle 1.2s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        @keyframes chipColorCycle {
            0% {
                background: #ff6b35;
                border-color: #ff6b35;
            }
            16.66% {
                background: #0096ff;
                border-color: #0096ff;
            }
            33.33% {
                background: #00ff88;
                border-color: #00ff88;
            }
            50% {
                background: #ff6b9d;
                border-color: #ff6b9d;
            }
            66.66% {
                background: #9d4edd;
                border-color: #9d4edd;
            }
            83.33% {
                background: #ff6b35;
                border-color: #ff6b35;
            }
            100% {
                background: #ff6b35;
                border-color: #ff6b35;
            }
        }

        .mode-chip-icon {
            width: 16px;
            height: 16px;
        }

        /* Results Section - Netflix Style */
        .results-section {
            display: none;
            padding: 0;
            overflow: visible;
            position: relative;
        }

        .results-section.visible {
            display: flex;
            gap: 40px;
            align-items: flex-start;
            overflow: visible;
        }
        
        .results-left {
            flex: 0 0 35%;
            max-width: 35%;
            min-width: 0;
            overflow: visible;
        }
        
        .results-right {
            flex: 0 0 60%;
            max-width: 60%;
            position: sticky;
            top: 100px;
            overflow: visible;
            align-self: flex-start;
        }
        
        @media (max-width: 1200px) {
            .results-section.visible {
                flex-direction: column;
            }
            
            .results-left {
                width: 100%;
            }
            
            .results-right {
                flex: 1;
                max-width: 100%;
                position: relative;
                top: 0;
                margin-top: 40px;
            }
            
            .search-heroes {
                height: 60vh;
                min-height: 500px;
            }
        }

        .result-row {
            margin-bottom: 32px;
            position: relative;
            z-index: 1;
            overflow: hidden;
        }

        .result-row-header {
            display: flex;
            align-items: baseline;
            gap: 12px;
            margin-bottom: 8px;
            position: relative;
            z-index: 1 !important;
            pointer-events: none;
        }

        .result-row-title {
            font-size: 14px;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.9);
            margin: 0;
            padding: 0;
        }

        .result-row-subtitle {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.5);
            font-weight: 400;
        }

        .result-card-badge {
            position: absolute;
            top: 6px;
            right: 6px;
            background: rgba(0, 0, 0, 0.6);
            padding: 3px 6px;
            border-radius: 3px;
            font-size: 9px;
            z-index: 5;
            backdrop-filter: blur(5px);
            box-shadow: none;
            display: flex;
            align-items: center;
            gap: 3px;
            color: rgba(255, 255, 255, 0.8);
        }
        
        .result-card-badge img {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            object-fit: contain;
            display: block;
        }
        
        .result-card-badge svg {
            width: 20px;
            height: 20px;
            display: block;
        }

        .result-row-carousel {
            position: relative;
            overflow: hidden;
            margin-bottom: 0;
            z-index: 1;
        }

        .result-row-container {
            display: flex;
            gap: 0;
            overflow-x: auto;
            overflow-y: hidden;
            scroll-behavior: smooth;
            padding: 4px 0 8px 0;
            margin: 0;
            scrollbar-width: none;
            position: relative;
            z-index: 1;
        }

        .result-row-container::-webkit-scrollbar {
            display: none;
        }

        .result-card {
            flex: 0 0 240px;
            height: 140px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 6px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.08);
            position: relative;
            cursor: pointer;
            margin-right: 10px;
            box-shadow: none;
            z-index: 2;
        }

        .result-card:hover {
            border-color: rgba(255, 255, 255, 0.15);
            background: rgba(0, 0, 0, 0.25);
            transition: all 0.2s ease;
        }
        
        
        .result-row-header {
            z-index: 1 !important;
        }

        .result-card-embed {
            width: 100%;
            height: 100%;
            border: none;
            background: rgba(0, 0, 0, 0.3);
            display: block;
            position: absolute;
            top: 0;
            left: 0;
            overflow: hidden;
            border-radius: 8px;
        }
        
        .result-card-preview {
            overflow: hidden;
            border-radius: 8px;
        }

        .result-card-preview {
            padding: 12px;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .result-card-title {
            font-size: 13px;
            font-weight: 500;
            margin-bottom: 6px;
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.3;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        .result-card-snippet {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.5);
            line-height: 1.4;
            flex: 1;
            margin-bottom: 8px;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        .result-card-actions {
            display: flex;
            gap: 4px;
        }

        .result-card-btn {
            padding: 4px 8px;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            color: rgba(255, 255, 255, 0.7);
            font-size: 10px;
            cursor: pointer;
            transition: all 0.15s;
            display: flex;
            align-items: center;
            gap: 3px;
        }

        .result-card-btn:hover {
            background: rgba(255, 255, 255, 0.12);
            border-color: rgba(255, 255, 255, 0.15);
            color: rgba(255, 255, 255, 0.9);
        }

        .result-card-btn-primary {
            background: rgba(255, 107, 53, 0.2);
            border-color: rgba(255, 107, 53, 0.3);
            color: rgba(255, 255, 255, 0.9);
        }

        .result-card-btn-primary:hover {
            background: rgba(255, 107, 53, 0.3);
            border-color: rgba(255, 107, 53, 0.4);
        }

        .icon-sm {
            width: 16px;
            height: 16px;
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 60px 20px;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top-color: #ff6b35;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Footer */
        .footer {
            position: fixed;
            bottom: 20px;
            right: 20px;
            color: rgba(255, 255, 255, 0.4);
            font-size: 11px;
            line-height: 1.6;
            background: transparent;
            text-align: right;
            z-index: 9998;
            font-family: 'Calibri Light', sans-serif;
            pointer-events: none;
        }

        .footer-label {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.6);
            margin-bottom: 4px;
        }

        .footer-author {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.55);
            margin-top: 2px;
            font-weight: 500;
        }

        .footer-tagline {
            font-size: 9px;
            color: rgba(255, 255, 255, 0.3);
            margin-top: 4px;
            font-style: italic;
        }

        .hidden {
            display: none !important;
        }

        /* Search Heroes Carousel - Cinematic */
        .search-heroes {
            position: relative;
            width: 100%;
            height: calc(100vh - 120px);
            min-height: 600px;
            max-height: 800px;
            overflow: hidden;
            border-radius: 16px;
        }

        .search-hero-container {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .search-hero {
            min-width: 100%;
            width: 100%;
            height: 100%;
            border-radius: 16px;
            overflow: hidden;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.5);
            position: relative;
            transition: border-color 0.5s ease;
        }
        
        .search-hero.google-active {
            border-color: rgba(234, 67, 53, 0.5);
            animation: googleColorShift 3s ease-in-out infinite;
        }
        
        .search-hero.bing-active {
            border-color: rgba(0, 120, 215, 0.5);
            animation: bingColorShift 3s ease-in-out infinite;
        }
        
        .search-hero.brave-active {
            border-color: rgba(255, 140, 0, 0.5);
            animation: braveColorShift 3s ease-in-out infinite;
        }
        
        .search-hero.wikipedia-active {
            border-color: rgba(255, 255, 255, 0.4);
            animation: wikipediaColorShift 3s ease-in-out infinite;
        }
        
        @keyframes googleColorShift {
            0% {
                border-color: rgba(234, 67, 53, 0.5);
                box-shadow: 0 4px 16px rgba(234, 67, 53, 0.3);
            }
            33% {
                border-color: rgba(52, 168, 83, 0.5);
                box-shadow: 0 4px 16px rgba(52, 168, 83, 0.3);
            }
            66% {
                border-color: rgba(66, 133, 244, 0.5);
                box-shadow: 0 4px 16px rgba(66, 133, 244, 0.3);
            }
            100% {
                border-color: rgba(234, 67, 53, 0.5);
                box-shadow: 0 4px 16px rgba(234, 67, 53, 0.3);
            }
        }
        
        @keyframes bingColorShift {
            0% {
                border-color: rgba(0, 120, 215, 0.5);
                box-shadow: 0 4px 16px rgba(0, 120, 215, 0.3);
            }
            50% {
                border-color: rgba(138, 43, 226, 0.5);
                box-shadow: 0 4px 16px rgba(138, 43, 226, 0.3);
            }
            100% {
                border-color: rgba(0, 120, 215, 0.5);
                box-shadow: 0 4px 16px rgba(0, 120, 215, 0.3);
            }
        }
        
        @keyframes braveColorShift {
            0% {
                border-color: rgba(255, 140, 0, 0.5);
                box-shadow: 0 4px 16px rgba(255, 140, 0, 0.3);
            }
            33% {
                border-color: rgba(255, 193, 7, 0.5);
                box-shadow: 0 4px 16px rgba(255, 193, 7, 0.3);
            }
            66% {
                border-color: rgba(255, 140, 0, 0.5);
                box-shadow: 0 4px 16px rgba(255, 140, 0, 0.3);
            }
            100% {
                border-color: rgba(255, 140, 0, 0.5);
                box-shadow: 0 4px 16px rgba(255, 140, 0, 0.3);
            }
        }
        
        @keyframes wikipediaColorShift {
            0% {
                border-color: rgba(255, 255, 255, 0.4);
                box-shadow: 0 4px 16px rgba(255, 255, 255, 0.2);
            }
            25% {
                border-color: rgba(200, 200, 200, 0.4);
                box-shadow: 0 4px 16px rgba(200, 200, 200, 0.2);
            }
            50% {
                border-color: rgba(150, 150, 150, 0.4);
                box-shadow: 0 4px 16px rgba(150, 150, 150, 0.2);
            }
            75% {
                border-color: rgba(200, 200, 200, 0.4);
                box-shadow: 0 4px 16px rgba(200, 200, 200, 0.2);
            }
            100% {
                border-color: rgba(255, 255, 255, 0.4);
                box-shadow: 0 4px 16px rgba(255, 255, 255, 0.2);
            }
        }

        .search-hero-iframe {
            width: 100%;
            height: 100%;
            border: none;
            position: relative;
            z-index: 0;
        }

        .search-hero-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to bottom, rgba(0, 0, 0, 0.1) 0%, transparent 20%, transparent 80%, rgba(0, 0, 0, 0.3) 100%);
            pointer-events: none;
            z-index: 1;
        }
        
        .search-hero-title {
            display: none;
        }

        .search-hero-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 40px;
            height: 40px;
            background: rgba(0, 0, 0, 0.7);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 20;
            transition: all 0.2s;
            backdrop-filter: blur(10px);
        }

        .search-hero-nav:hover {
            background: rgba(255, 107, 53, 0.8);
            border-color: #ff6b35;
            box-shadow: 0 4px 12px rgba(255, 107, 53, 0.4);
            transform: translateY(-50%) scale(1.1);
        }

        .search-hero-nav.prev {
            left: 20px;
        }

        .search-hero-nav.next {
            right: 20px;
        }

        .search-hero-nav svg {
            width: 20px;
            height: 20px;
            color: #ffffff;
        }

        .search-hero-indicators {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 8px;
            z-index: 20;
        }

        .search-hero-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .search-hero-indicator.active {
            background: #ff6b35;
            width: 24px;
            border-radius: 4px;
        }

        /* AI Modal */
        .ai-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
        }

        .ai-modal.open {
            display: flex;
        }

        .ai-modal-content {
            width: 90%;
            max-width: 1200px;
            height: 90%;
            background: #141414;
            border-radius: 8px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .ai-modal-header {
            padding: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .ai-modal-title {
            font-size: 20px;
            font-weight: 600;
            color: #ffffff;
        }

        .ai-modal-close {
            background: transparent;
            border: none;
            color: #ffffff;
            font-size: 24px;
            cursor: pointer;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .ai-modal-close:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .ai-modal-iframe {
            flex: 1;
            width: 100%;
            border: none;
            background: #000000;
        }

        /* Homepage Button */
        .homepage-btn {
            padding: 6px 12px;
            background: #ff6b35;
            border: none;
            border-radius: 6px;
            color: #ffffff;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .homepage-btn:hover {
            background: #ff8555;
            transform: translateY(-1px);
        }

        .homepage-count {
            font-size: 11px;
            color: rgba(255, 255, 255, 0.6);
            margin-top: 4px;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header {
                padding: 16px 20px;
                max-width: calc(100% - 40px);
            }
            
            .header.search-active {
                padding: 12px 16px;
                flex-wrap: wrap;
            }

            .header-search {
                width: 100%;
            }
            
            .header.search-active .header-search {
                order: 3;
                width: 100%;
                max-width: 100%;
                margin: 12px 0 0 0;
            }
            
            .footer {
                bottom: 12px;
                right: 12px;
                font-size: 10px;
            }
            
            .footer-label {
                font-size: 11px;
            }
            
            .footer-author {
                font-size: 9px;
            }
            
            .footer-tagline {
                font-size: 8px;
            }

            .header-search-input {
                padding: 10px 40px 10px 16px;
                font-size: 16px;
            }

            .header-actions {
                gap: 6px;
            }

            .header-btn, .homepage-btn {
                padding: 6px 10px;
                font-size: 12px;
            }

            .main-content {
                padding: 16px;
            }

            .main-content.panel-open {
                padding-left: 16px;
            }

            .recommendations-panel {
                width: 100%;
            }

            .search-heroes {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .search-heroes {
                grid-template-columns: 1fr;
            }

            .search-hero {
                height: 500px;
            }

            .hero {
                padding: 40px 0;
            }

            .hero-title {
                font-size: 32px;
            }

            .hero-subtitle {
                font-size: 16px;
            }

            .mode-chip {
                padding: 8px 16px;
                font-size: 13px;
            }

            .result-card {
                flex: 0 0 200px;
                height: 112px;
            }

            .results-section {
                padding: 24px 0;
            }
        }

        @media (max-width: 480px) {
            .header {
                padding: 8px 12px;
            }

            .header-search-input {
                padding: 10px 36px 10px 14px;
            }

            .hero-title {
                font-size: 28px;
            }

            .result-card {
                flex: 0 0 180px;
                height: 100px;
            }

            .result-card-preview {
                padding: 10px;
            }

            .search-hero {
                height: 400px;
            }
        }
    </style>
</head>
<body>
    <!-- Background Video Container -->
    <div class="bg-video-container" id="bgVideoContainer">
        <video class="bg-video" id="bgVideo1" data-src="BG1.mp4" muted loop playsinline preload="auto"></video>
        <video class="bg-video" id="bgVideo2" data-src="BG2.mp4" muted loop playsinline preload="auto"></video>
        <video class="bg-video" id="bgVideo3" data-src="BG3.mp4" muted loop playsinline preload="auto"></video>
        <video class="bg-video" id="bgVideo4" data-src="BG4.mp4" muted loop playsinline preload="auto"></video>
        <video class="bg-video" id="bgVideo5" data-src="BG5.mp4" muted loop playsinline preload="auto"></video>
        <video class="bg-video" id="bgVideo6" data-src="BG6.mp4" muted loop playsinline preload="auto"></video>
    </div>
    
    <!-- Header -->
    <header class="header" id="mainHeader">
        <div class="header-search">
            <input 
                type="search"
                class="header-search-input" 
                id="searchInput" 
                placeholder="Search the web, shopping, AI, community..."
                autocomplete="off"
                enterkeyhint="search"
            />
            <svg class="header-search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="11" cy="11" r="8"></circle>
                <path d="m21 21-4.35-4.35"></path>
            </svg>
        </div>
        <div class="header-actions">
            <button class="homepage-btn" id="setHomepageBtn" title="Set as Homepage">
                <svg class="header-btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                    <polyline points="9 22 9 12 15 12 15 22"></polyline>
                </svg>
            </button>
            <button class="header-btn" id="recommendationsToggle" title="Suggestions">
                <svg class="header-btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
            </button>
        </div>
    </header>

    <!-- Recommendations Side Panel -->
    <div class="recommendations-panel" id="recommendationsPanel">
        <button class="recommendations-close" id="recommendationsClose">×</button>
        <div class="recommendations-header">
            <div class="recommendations-title">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: inline-block; vertical-align: middle; margin-right: 6px;">
                    <circle cx="12" cy="12" r="10"></circle>
                    <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
                Quick picks
            </div>
        </div>
        <div class="recommendations-section">
            <div class="recommendations-section-title">
                Recent
                <button class="recommendations-clear" id="clearRecent">Clear</button>
            </div>
            <div id="recentSearchesList"></div>
        </div>
        <div class="recommendations-section">
            <div class="recommendations-section-title">Suggestions</div>
            <div id="popularSearchesList"></div>
        </div>
    </div>

    <!-- Main Content -->
    <main class="main-content" id="mainContent">
        <!-- Hero Section -->
        <section class="hero" id="hero">
            <h1 class="hero-title hero-title-empty">Vizoo</h1>
            <p class="hero-subtitle hero-subtitle-empty" id="typingText1" style="font-size: clamp(18px, 4vw, 28px); color: rgba(255, 107, 53, 0.9); margin-top: 24px; min-height: 1.6em;"></p>
            <div class="mode-chips" id="modeChips">
                <button class="mode-chip active" data-mode="all">
                    <svg class="mode-chip-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="m21 21-4.35-4.35"></path>
                    </svg>
                    All
                </button>
                <button class="mode-chip" data-mode="web">
                    <svg class="mode-chip-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="2" y1="12" x2="22" y2="12"></line>
                        <path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path>
                    </svg>
                    Web
                </button>
                <button class="mode-chip" data-mode="shopping">
                    <svg class="mode-chip-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="9" cy="21" r="1"></circle>
                        <circle cx="20" cy="21" r="1"></circle>
                        <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                    </svg>
                    Shopping
                </button>
                <button class="mode-chip" data-mode="ai">
                    <svg class="mode-chip-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="9" y1="3" x2="9" y2="21"></line>
                        <line x1="3" y1="9" x2="21" y2="9"></line>
                    </svg>
                    AI
                </button>
                <button class="mode-chip" data-mode="social">
                    <svg class="mode-chip-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                        <circle cx="9" cy="7" r="4"></circle>
                        <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                    </svg>
                    Social
                </button>
            </div>
        </section>

        <!-- Results Section -->
        <section class="results-section" id="resultsSection"></section>
    </main>

    <!-- AI Modal -->
    <div class="ai-modal" id="aiModal">
        <div class="ai-modal-content">
            <div class="ai-modal-header">
                <div class="ai-modal-title" id="aiModalTitle">AI Assistant</div>
                <button class="ai-modal-close" id="aiModalClose">×</button>
            </div>
            <iframe class="ai-modal-iframe" id="aiModalIframe"></iframe>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-label">Vizoo Home</div>
        <div class="footer-author">BY VIPUL H HARIHAR</div>
        <div class="footer-tagline">WE KNOW IT'S HOME</div>
    </footer>

    <script>
        // State
        const state = {
            query: '',
            mode: 'all',
            results: {},
            recentSearches: []
        };

        // DOM Elements
        const searchInput = document.getElementById('searchInput');
        const hero = document.getElementById('hero');
        const resultsSection = document.getElementById('resultsSection');
        const modeChips = document.getElementById('modeChips');
        const recommendationsPanel = document.getElementById('recommendationsPanel');
        const recommendationsToggle = document.getElementById('recommendationsToggle');
        const recommendationsClose = document.getElementById('recommendationsClose');
        const mainContent = document.getElementById('mainContent');
        const recentSearchesList = document.getElementById('recentSearchesList');
        const popularSearchesList = document.getElementById('popularSearchesList');
        const clearRecentButton = document.getElementById('clearRecent');

        // Load recent searches with timestamps
        try {
            const stored = JSON.parse(localStorage.getItem('vizoo_recent') || '[]');
            state.recentSearches = stored.map(item => {
                if (typeof item === 'string') {
                    return { query: item, timestamp: Date.now() };
                }
                return item;
            });
        } catch (e) {}
        
        // Get time ago string
        function getTimeAgo(timestamp) {
            const now = Date.now();
            const diff = now - timestamp;
            const seconds = Math.floor(diff / 1000);
            const minutes = Math.floor(seconds / 60);
            const hours = Math.floor(minutes / 60);
            const days = Math.floor(hours / 24);
            
            if (seconds < 60) return 'Just now';
            if (minutes < 60) return `${minutes}m ago`;
            if (hours < 24) return `${hours}h ago`;
            if (days < 7) return `${days}d ago`;
            return new Date(timestamp).toLocaleDateString();
        }
        
        // Delete recent search
        function deleteRecentSearch(index) {
            state.recentSearches.splice(index, 1);
            try {
                localStorage.setItem('vizoo_recent', JSON.stringify(state.recentSearches));
            } catch (e) {}
            updateRecommendationsPanel();
        }

        // Update recommendations panel - Recent + suggestions
        function updateRecommendationsPanel() {
            if (recentSearchesList) {
                const recents = state.recentSearches.slice(0, 10);
                recentSearchesList.innerHTML = recents.length ? recents.map((search, index) => {
                    const searchData = typeof search === 'object' ? search : { query: search, timestamp: Date.now() };
                    const timeAgo = getTimeAgo(searchData.timestamp || Date.now());
                    return `
                        <div class="recommendation-item" onclick="selectRecommendation('${searchData.query.replace(/'/g, "\\'")}')">
                            <div class="recommendation-item-content">
                                <div class="recommendation-item-text">${escapeHtml(searchData.query)}</div>
                                <div class="recommendation-item-time">${timeAgo}</div>
                            </div>
                            <button class="recommendation-item-delete" onclick="event.stopPropagation(); deleteRecentSearch(${index})" title="Delete">
                                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="18" y1="6" x2="6" y2="18"></line>
                                    <line x1="6" y1="6" x2="18" y2="18"></line>
                                </svg>
                            </button>
                        </div>
                    `;
                }).join('') : '<div class="recommendation-item-text" style="color: rgba(255, 255, 255, 0.5); padding: 12px;">No recent searches</div>';
            }

            if (popularSearchesList) {
                const popular = [
                    'artificial intelligence',
                    'machine learning',
                    'web development',
                    'python programming',
                    'javascript tutorial',
                    'react framework',
                    'design systems',
                    'cloud computing'
                ];
                popularSearchesList.innerHTML = popular.map(search => `
                    <div class="recommendation-item" onclick="selectRecommendation('${search.replace(/'/g, "\\'")}')">
                        <div class="recommendation-item-text">${escapeHtml(search)}</div>
                    </div>
                `).join('');
            }
        }

        function selectRecommendation(query) {
            searchInput.value = query;
            performSearch();
        }
        
        // Background video slideshow
        let bgSlideshowInterval = null;
        let currentBgIndex = 1;
        let allVideos = [];
        let currentVideo = null;
        
        function initBackgroundVideos() {
            for (let i = 1; i <= 6; i++) {
                const video = document.getElementById(`bgVideo${i}`);
                if (video) {
                    const src = video.getAttribute('data-src');
                    if (src) {
                        video.src = src;
                        allVideos.push(video);
                        
                        // Preload first video immediately
                        if (i === 1) {
                            video.load();
                        }
                        
                        // Handle video errors
                        video.addEventListener('error', (e) => {
                            console.warn(`Background video BG${i}.mp4 failed to load`);
                        });
                    }
                }
            }
        }
        
        function playVideo(video) {
            if (!video) return;
            
            // Fade out current video
            if (currentVideo && currentVideo !== video) {
                currentVideo.classList.remove('active', 'playing');
                currentVideo.pause();
                currentVideo.currentTime = 0;
            }
            
            // Fade in and play new video
            currentVideo = video;
            video.classList.add('active');
            
            // Start playing
            video.play().then(() => {
                video.classList.add('playing');
            }).catch(err => {
                console.warn('Video autoplay prevented:', err);
                // Try again after user interaction
                document.addEventListener('click', () => {
                    video.play().then(() => {
                        video.classList.add('playing');
                    });
                }, { once: true });
            });
        }
        
        function startBackgroundSlideshow() {
            if (document.body.classList.contains('search-started')) return;
            
            if (allVideos.length === 0) {
                initBackgroundVideos();
            }
            
            // Wait a bit for videos to load, then start
            setTimeout(() => {
                if (document.body.classList.contains('search-started')) return;
                
                // Start with first video
                if (allVideos.length > 0 && !currentVideo) {
                    currentBgIndex = 1;
                    const firstVideo = allVideos[0];
                    if (firstVideo && firstVideo.readyState >= 2) {
                        playVideo(firstVideo);
                    } else {
                        firstVideo.addEventListener('canplay', () => {
                            if (!document.body.classList.contains('search-started')) {
                                playVideo(firstVideo);
                            }
                        }, { once: true });
                    }
                }
                
                // Cycle through videos
                bgSlideshowInterval = setInterval(() => {
                    if (document.body.classList.contains('search-started')) {
                        stopBackgroundSlideshow();
                        return;
                    }
                    
                    currentBgIndex = (currentBgIndex % 6) + 1;
                    const nextVideo = allVideos[currentBgIndex - 1];
                    if (nextVideo) {
                        // Preload next video
                        if (nextVideo.readyState < 2) {
                            nextVideo.load();
                        }
                        playVideo(nextVideo);
                    }
                }, 10000); // Change every 10 seconds (longer for videos)
            }, 500);
        }
        
        function stopBackgroundSlideshow() {
            if (bgSlideshowInterval) {
                clearInterval(bgSlideshowInterval);
                bgSlideshowInterval = null;
            }
            
            // Fade out and stop all videos
            allVideos.forEach(video => {
                video.classList.remove('active', 'playing');
                video.pause();
                video.currentTime = 0;
            });
            
            currentVideo = null;
            document.body.classList.add('search-started');
        }
        
        // Global functions
        window.deleteRecentSearch = deleteRecentSearch;

        // Toggle recommendations panel
        recommendationsToggle.addEventListener('click', () => {
            recommendationsPanel.classList.toggle('open');
            mainContent.classList.toggle('panel-open');
        });

        recommendationsClose.addEventListener('click', () => {
            recommendationsPanel.classList.remove('open');
            mainContent.classList.remove('panel-open');
        });

        // Clear recent
        if (clearRecentButton) {
            clearRecentButton.addEventListener('click', () => {
                state.recentSearches = [];
                try {
                    localStorage.setItem('vizoo_recent', JSON.stringify(state.recentSearches));
                } catch (e) {}
                updateRecommendationsPanel();
            });
        }

        // Mode chips
        modeChips.addEventListener('click', (e) => {
            if (e.target.classList.contains('mode-chip')) {
                modeChips.querySelectorAll('.mode-chip').forEach(chip => chip.classList.remove('active'));
                e.target.classList.add('active');
                state.mode = e.target.dataset.mode;
                if (state.query) performSearch();
            }
        });

        // Search input handlers - using browser built-in features
        searchInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                e.preventDefault();
                performSearch();
            }
        });

        // Use browser's search history and autocomplete
        searchInput.addEventListener('input', (e) => {
            // Browser will show search suggestions automatically
            state.query = e.target.value;
        });

        // Perform search using browser capabilities
        async function performSearch() {
            const query = searchInput.value.trim();
            if (!query) return;

            state.query = query;
            
            // Save to recent (dedup, keep latest 20) with timestamp
            const existingIndex = state.recentSearches.findIndex(item => {
                const searchQuery = typeof item === 'string' ? item : item.query;
                return searchQuery === query;
            });
            if (existingIndex !== -1) {
                state.recentSearches.splice(existingIndex, 1);
            }
            state.recentSearches.unshift({ query: query, timestamp: Date.now() });
            state.recentSearches = state.recentSearches.slice(0, 20);
            try {
                localStorage.setItem('vizoo_recent', JSON.stringify(state.recentSearches));
            } catch (e) {}

            updateRecommendationsPanel();

            hero.classList.add('hidden');
            resultsSection.classList.add('visible');
            
            // Add has-results class to main content
            mainContent.classList.add('has-results');
            
            // Move search bar to top smoothly - ensure it's always visible
            const mainHeader = document.getElementById('mainHeader');
            if (mainHeader) {
                // Force visibility immediately
                mainHeader.style.opacity = '1';
                mainHeader.style.zIndex = '9999';
                setTimeout(() => {
                    mainHeader.classList.add('search-active');
                    // Ensure it stays visible
                    mainHeader.style.opacity = '1';
                    mainHeader.style.zIndex = '9999';
                }, 50);
            }
            
            // Stop background slideshow when search begins
            stopBackgroundSlideshow();
            
            // Trigger quick color animation on search
            document.body.classList.add('search-animating');
            setTimeout(() => {
                document.body.classList.remove('search-animating');
            }, 1200);
            
            resultsSection.innerHTML = '<div class="loading"><div class="loading-spinner"></div><div>Searching...</div></div>';

            // Determine engines - Always include Google and Bing
            let engines = [];
            switch(state.mode) {
                case 'web':
                    engines = ['google', 'bing', 'brave', 'wikipedia'];
                    break;
                case 'shopping':
                    engines = ['google', 'bing', 'amazon'];
                    break;
                case 'ai':
                    engines = ['google', 'bing', 'chatgpt', 'perplexity', 'grok'];
                    break;
                case 'social':
                    engines = ['google', 'bing', 'youtube', 'reddit'];
                    break;
                default:
                    engines = ['google', 'bing', 'chatgpt', 'perplexity', 'grok', 'youtube', 'brave', 'wikipedia', 'amazon', 'reddit'];
            }

            const promises = engines.map(engine => searchWithEngine(engine, query));
            await Promise.allSettled(promises);
            
            displayResults();
        }

        async function searchWithEngine(engine, query) {
            try {
                let results = [];
                switch(engine) {
                    case 'google':
                        results = await searchGoogle(query);
                        break;
                    case 'bing':
                        results = await searchBing(query);
                        break;
                    case 'youtube':
                        results = await searchYouTube(query);
                        break;
                    case 'brave':
                        results = await searchBrave(query);
                        break;
                    case 'amazon':
                        results = await searchAmazon(query);
                        break;
                    case 'chatgpt':
                        results = await searchChatGPT(query);
                        break;
                    case 'perplexity':
                        results = await searchPerplexity(query);
                        break;
                    case 'grok':
                        results = await searchGrok(query);
                        break;
                    case 'reddit':
                        results = await searchReddit(query);
                        break;
                    case 'wikipedia':
                        results = await searchWikipedia(query);
                        break;
                }
                state.results[engine] = results;
            } catch (error) {
                console.error(`Error searching ${engine}:`, error);
                state.results[engine] = [];
            }
        }

        // Search functions using browser capabilities and direct URLs
        async function searchGoogle(query) {
            // Try multiple Google URLs - some may work better for logged-in users
            // Using &udm=2 for simplified results that might embed better
            return [{
                url: `https://www.google.com/search?q=${encodeURIComponent(query)}&igu=1&theme=dark&source=hp&udm=2`,
                title: `Google Search: ${query}`,
                snippet: `Search results for "${query}"`,
                embeddable: true,
                type: 'google',
                // Alternative URL for fallback
                altUrl: `https://www.google.com/search?q=${encodeURIComponent(query)}&theme=dark`
            }];
        }

        async function searchBing(query) {
            return [{
                url: `https://www.bing.com/search?q=${encodeURIComponent(query)}&FORM=HDRSC1&darkoverridemode=1`,
                title: `Bing Search: ${query}`,
                snippet: `Search results for "${query}" on Bing`,
                embeddable: true,
                type: 'bing'
            }];
        }

        async function searchYouTube(query) {
            // Use YouTube's official embed API for better compatibility
            // Try to fetch video IDs from search and use proper embed format
            const searchUrl = `https://www.youtube.com/results?search_query=${encodeURIComponent(query)}`;
            // Use YouTube's embed search format - this is the official way to embed search results
            const embedUrl = `https://www.youtube.com/embed?listType=search&list=${encodeURIComponent(query)}&enablejsapi=1&origin=${encodeURIComponent(window.location.origin)}&modestbranding=1&rel=0&autoplay=0&mute=0`;
            
            return [
                {
                    url: searchUrl,
                    title: `YouTube: ${query}`,
                    snippet: `Watch videos about ${query} on YouTube`,
                    embeddable: true, // Try embedding with proper YouTube embed API
                    type: 'youtube',
                    embedUrl: embedUrl
                }
            ];
        }

        async function searchBrave(query) {
            return [{
                url: `https://search.brave.com/search?q=${encodeURIComponent(query)}`,
                title: `Brave Search: ${query}`,
                snippet: `Search results for "${query}" on Brave`,
                embeddable: true,
                type: 'brave'
            }];
        }

        async function searchAmazon(query) {
            return [{
                url: `https://www.amazon.com/s?k=${encodeURIComponent(query)}`,
                title: `Amazon: ${query}`,
                embeddable: false
            }];
        }

        async function searchChatGPT(query) {
            return [{
                url: `https://chat.openai.com/?q=${encodeURIComponent(query)}`,
                title: `ChatGPT: ${query}`,
                snippet: `Ask ChatGPT about: ${query}`,
                embeddable: false
            }];
        }

        async function searchPerplexity(query) {
            return [{
                url: `https://www.perplexity.ai/search?q=${encodeURIComponent(query)}`,
                title: `Perplexity: ${query}`,
                embeddable: false
            }];
        }

        async function searchGrok(query) {
            return [{
                url: `https://x.com/i/grok?text=${encodeURIComponent(query)}`,
                title: `Grok: ${query}`,
                snippet: `Ask Grok about: ${query}`,
                embeddable: false
            }];
        }

        async function searchReddit(query) {
            return [{
                url: `https://www.reddit.com/search/?q=${encodeURIComponent(query)}`,
                title: `Reddit: ${query}`,
                embeddable: true
            }];
        }


        async function searchWikipedia(query) {
            try {
                const response = await fetch(`https://en.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(query)}`);
                const data = await response.json();
                
                if (data.extract) {
                    return [{
                        url: `https://en.wikipedia.org/wiki/${encodeURIComponent(query)}?useskin=vector-dark`,
                        title: data.title || query,
                        snippet: data.extract,
                        embeddable: true,
                        type: 'wikipedia'
                    }];
                }
            } catch (error) {
                console.error('Wikipedia API error:', error);
            }
            
            return [{
                url: `https://en.wikipedia.org/wiki/${encodeURIComponent(query)}?useskin=vector-dark`,
                title: `Wikipedia: ${query}`,
                snippet: `Wikipedia article about ${query}`,
                embeddable: true,
                type: 'wikipedia'
            }];
        }

        // Display results - Google first, then rows, AI opens in modal
        function displayResults() {
            const engineNames = {
                google: 'Google',
                bing: 'Bing',
                youtube: 'YouTube',
                brave: 'Brave',
                wikipedia: 'Wikipedia',
                amazon: 'Amazon',
                chatgpt: 'ChatGPT',
                perplexity: 'Perplexity',
                grok: 'Grok',
                reddit: 'Reddit'
            };

            const aiEngines = ['chatgpt', 'perplexity', 'grok'];
            let html = '';
            let heroHTML = '';
            
            // Main hero: Google, Bing, Wikipedia
            const heroes = [];
            
            // Google first (priority)
            if (state.results.google && state.results.google[0]) {
                heroes.push({ name: 'Google', ...state.results.google[0] });
            }
            // Bing second
            if (state.results.bing && state.results.bing[0]) {
                heroes.push({ name: 'Bing', ...state.results.bing[0] });
            }
            // Wikipedia third
            if (state.results.wikipedia && state.results.wikipedia[0]) {
                heroes.push({ name: 'Wikipedia', ...state.results.wikipedia[0] });
            }
            
            // Fallback if no heroes
            if (heroes.length === 0) {
                heroes.push({ name: 'Google', url: `https://www.google.com/search?q=${encodeURIComponent(state.query)}&theme=dark`, title: `Google: ${state.query}` });
            }

            // Store hero HTML separately for right column
            if (heroes.length > 0) {
                heroHTML = `
                    <div class="search-heroes">
                        <div class="search-hero-container" id="searchHeroContainer">
                            ${heroes.map((hero, idx) => `
                                <div class="search-hero ${idx === 0 ? 'active' : ''} ${hero.name.toLowerCase()}-active">
                                    <div class="search-hero-overlay"></div>
                                    <iframe 
                                        src="${hero.url}"
                                        class="search-hero-iframe"
                                        allow="fullscreen; autoplay; encrypted-media; picture-in-picture; web-share; clipboard-read; clipboard-write"
                                        sandbox="allow-same-origin allow-scripts allow-popups allow-forms allow-top-navigation allow-modals allow-popups-to-escape-sandbox allow-storage-access-by-user-activation"
                                        loading="lazy"
                                        referrerpolicy="strict-origin-when-cross-origin"
                                        credentialless="false"
                                        allowfullscreen
                                        onload="checkIframeLoad('hero-${idx}', '${hero.url.replace(/'/g, "\\'")}', '${escapeHtml(hero.title || state.query)}')"
                                        onerror="handleIframeError('hero-${idx}', '${hero.url.replace(/'/g, "\\'")}', '${escapeHtml(hero.title || state.query)}', '${escapeHtml(hero.snippet || '')}')"
                                    ></iframe>
                                </div>
                            `).join('')}
                        </div>
                        ${heroes.length > 1 ? `
                            <button class="search-hero-nav prev" onclick="navigateHero(-1)">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="15 18 9 12 15 6"></polyline>
                                </svg>
                            </button>
                            <button class="search-hero-nav next" onclick="navigateHero(1)">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="9 18 15 12 9 6"></polyline>
                                </svg>
                            </button>
                            <div class="search-hero-indicators">
                                ${heroes.map((_, idx) => `
                                    <div class="search-hero-indicator ${idx === 0 ? 'active' : ''}" onclick="goToHero(${idx})"></div>
                                `).join('')}
                            </div>
                        ` : ''}
                    </div>
                `;
            }
            

            // Dedicated Video row (YouTube only)
            const videoCards = (state.results.youtube || []).map((r, idx) => ({
                engine: 'youtube',
                title: r.title,
                url: r.url,
                embedUrl: r.embedUrl,
                snippet: r.snippet || 'YouTube',
                embeddable: r.embeddable !== false,
                type: 'youtube',
                id: `yt-ai-${idx}`
            }));

            // YouTube Videos row
            if (videoCards.length > 0) {
                html += `
                    <div class="result-row">
                        <div class="result-row-header">
                            <h3 class="result-row-title">YouTube Videos</h3>
                            <span class="result-row-subtitle">${videoCards.length} videos</span>
                        </div>
                        <div class="result-row-carousel">
                            <div class="result-row-container">
                                ${videoCards.map((item, index) => {
                                    return `
                                        <div class="result-card" onclick="window.open('${item.url.replace(/'/g, "\\'")}', '_blank')" id="${item.id || 'yt-' + index}">
                                            <div class="result-card-badge">${getEngineIcon('youtube')}</div>
                                            <div class="result-card-preview">
                                                <div class="result-card-title">${escapeHtml(item.title)}</div>
                                                <div class="result-card-snippet">${escapeHtml(item.snippet)}</div>
                                                <div class="result-card-actions">
                                                    <button class="result-card-btn result-card-btn-primary" onclick="event.stopPropagation(); window.open('${item.url.replace(/'/g, "\\'")}', '_blank')">
                                                        <svg class="icon-sm" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                            <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                                                            <polyline points="15 3 21 3 21 9"></polyline>
                                                            <line x1="10" y1="14" x2="21" y2="3"></line>
                                                        </svg>
                                                        Open YouTube
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>
                    </div>
                `;
            }
            
            // AI Assistants row (only show once)
            const aiCards = [];
            aiEngines.forEach(engine => {
                const res = state.results[engine];
                if (res && res.length > 0) {
                    const r = res[0];
                    aiCards.push({
                        engine,
                        title: engineNames[engine],
                        url: r.url,
                        snippet: r.snippet || `Open ${engineNames[engine]} for ${state.query}`
                    });
                }
            });
            
            if (aiCards.length > 0) {
                html += `
                    <div class="result-row">
                        <div class="result-row-header">
                            <h3 class="result-row-title">AI Assistants</h3>
                            <span class="result-row-subtitle">${aiCards.length} assistants</span>
                        </div>
                        <div class="result-row-carousel">
                            <div class="result-row-container">
                                ${aiCards.map((item, index) => `
                                    <div class="result-card" onclick="window.open('${item.url.replace(/'/g, "\\'")}', '_blank')">
                                        <div class="result-card-badge">${getEngineIcon(item.engine)}</div>
                                        <div class="result-card-preview">
                                            <div class="result-card-title">${escapeHtml(item.title)}</div>
                                            <div class="result-card-snippet">${escapeHtml(item.snippet)}</div>
                                            <div class="result-card-actions">
                                                <button class="result-card-btn result-card-btn-primary" onclick="event.stopPropagation(); window.open('${item.url.replace(/'/g, "\\'")}', '_blank')">
                                                    <svg class="icon-sm" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                        <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                                                        <polyline points="15 3 21 3 21 9"></polyline>
                                                        <line x1="10" y1="14" x2="21" y2="3"></line>
                                                    </svg>
                                                    Open
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                `;
            }

            // Merge all results into one unified row (excluding Google, Bing, Brave, Wikipedia, YouTube, and AI)
            const allResults = [];
            Object.keys(state.results).forEach(engine => {
                if (engine === 'google' || engine === 'bing' || engine === 'brave' || engine === 'wikipedia' || engine === 'youtube' || aiEngines.includes(engine)) return;
                
                const results = state.results[engine];
                if (results.length === 0) return;
                
                results.forEach((result, index) => {
                    allResults.push({ engine, result, index });
                });
            });
            
            // Render single unified row with all results
            if (allResults.length > 0) {
                html += `
                    <div class="result-row">
                        <div class="result-row-header">
                            <h3 class="result-row-title">All Results</h3>
                            <span class="result-row-subtitle">${allResults.length} sources</span>
                        </div>
                        <div class="result-row-carousel">
                            <div class="result-row-container">
                `;
                
                allResults.forEach(({ engine, result, index }) => {
                    const cardId = `card-${engine}-${index}`;
                    let cardHtml = '';
                    
                    // Try to embed if embeddable
                    if (result.embeddable && (result.type === 'youtube' || result.type === 'reddit' || result.type === 'google' || result.type === 'bing' || result.type === 'brave' || result.type === 'wikipedia')) {
                        const embedSrc = result.embedUrl || result.url;
                        cardHtml = `
                            <div class="result-card" id="${cardId}">
                                <div class="result-card-badge">${getEngineIcon(engine)}</div>
                                <iframe 
                                    class="result-card-embed"
                                    src="${embedSrc}"
                                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                    allowfullscreen
                                    ${result.type === 'youtube' ? 'sandbox="allow-same-origin allow-scripts allow-popups allow-forms" loading="lazy"' : ''}
                                    onerror="handleIframeError('${cardId}', '${result.url.replace(/'/g, "\\'")}', '${escapeHtml(result.title)}', '${escapeHtml(result.snippet || '')}')"
                                ></iframe>
                                <div class="result-card-preview" style="display: none;" id="preview-${cardId}">
                                    <div class="result-card-title">${escapeHtml(result.title)}</div>
                                    <div class="result-card-snippet">${escapeHtml(result.snippet || `Open ${engineNames[engine] || engine} for "${state.query}"`)}</div>
                                    <div class="result-card-actions">
                                        <button class="result-card-btn result-card-btn-primary" onclick="window.open('${result.url.replace(/'/g, "\\'")}', '_blank')">
                                            <svg class="icon-sm" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                                                <polyline points="15 3 21 3 21 9"></polyline>
                                                <line x1="10" y1="14" x2="21" y2="3"></line>
                                            </svg>
                                            ${result.type === 'youtube' ? 'Open YouTube' : 'Open'}
                                        </button>
                                    </div>
                                </div>
                            </div>
                        `;
                    } else {
                        // Preview card for non-embeddable
                        cardHtml = `
                            <div class="result-card" onclick="window.open('${result.url.replace(/'/g, "\\'")}', '_blank')">
                                <div class="result-card-badge">${getEngineIcon(engine)}</div>
                                <div class="result-card-preview">
                                    <div class="result-card-title">${escapeHtml(result.title)}</div>
                                    <div class="result-card-snippet">${escapeHtml(result.snippet || `Open ${engineNames[engine] || engine} for "${state.query}"`)}</div>
                                    <div class="result-card-actions">
                                        <button class="result-card-btn result-card-btn-primary" onclick="event.stopPropagation(); window.open('${result.url.replace(/'/g, "\\'")}', '_blank')">
                                            <svg class="icon-sm" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                                                <polyline points="15 3 21 3 21 9"></polyline>
                                                <line x1="10" y1="14" x2="21" y2="3"></line>
                                            </svg>
                                            Open
                                        </button>
                                    </div>
                                </div>
                            </div>
                        `;
                    }
                    html += cardHtml;
                });
                
                html += `
                            </div>
                        </div>
                    </div>
                `;
            }


            // Wrap in two-column layout
            let finalHTML = '';
            if (heroHTML && html) {
                finalHTML = `
                    <div class="results-left">
                        ${html}
                    </div>
                    <div class="results-right">
                        ${heroHTML}
                    </div>
                `;
            } else if (html) {
                finalHTML = html;
            } else {
                finalHTML = '<div class="loading"><div>No results found</div></div>';
            }
            
            resultsSection.innerHTML = finalHTML;
        }

        // Open AI in modal
        function openAIModal(url, title) {
            const modal = document.getElementById('aiModal');
            const iframe = document.getElementById('aiModalIframe');
            const modalTitle = document.getElementById('aiModalTitle');
            
            modalTitle.textContent = title;
            iframe.src = url;
            modal.classList.add('open');
        }

        // Initialize AI modal handlers
        function initAIModal() {
            const aiModal = document.getElementById('aiModal');
            const aiModalClose = document.getElementById('aiModalClose');
            
            if (aiModalClose) {
                aiModalClose.addEventListener('click', () => {
                    if (aiModal) {
                        aiModal.classList.remove('open');
                        const iframe = document.getElementById('aiModalIframe');
                        if (iframe) iframe.src = '';
                    }
                });
            }
            
            if (aiModal) {
                aiModal.addEventListener('click', (e) => {
                    if (e.target === aiModal) {
                        aiModal.classList.remove('open');
                        const iframe = document.getElementById('aiModalIframe');
                        if (iframe) iframe.src = '';
                    }
                });
            }
        }

        function handleIframeError(cardId, url, title, snippet) {
            const card = document.getElementById(cardId);
            if (card) {
                const iframe = card.querySelector('.result-card-embed');
                const preview = card.querySelector(`#preview-${cardId}`);
                if (iframe) {
                    iframe.style.display = 'none';
                }
                if (preview) {
                    preview.style.display = 'flex';
                } else {
                    card.innerHTML = `
                        <div class="result-card-preview">
                            <div class="result-card-title">${title || 'Content blocked'}</div>
                            <div class="result-card-snippet">${snippet || 'This content cannot be embedded. Click below to open in a new tab.'}</div>
                            <div class="result-card-actions">
                                <button class="result-card-btn result-card-btn-primary" onclick="window.open('${url}', '_blank')">
                                    <svg class="icon-sm" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                                        <polyline points="15 3 21 3 21 9"></polyline>
                                        <line x1="10" y1="14" x2="21" y2="3"></line>
                                    </svg>
                                    Open in New Tab
                                </button>
                                <button class="result-card-btn" onclick="navigator.clipboard.writeText('${url}')">
                                    <svg class="icon-sm" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                    </svg>
                                    Copy
                                </button>
                            </div>
                        </div>
                    `;
                }
            }
        }

        function checkIframeLoad(cardId, url, title) {
            setTimeout(() => {
                const card = document.getElementById(cardId);
                if (!card) return;
                
                // Check if it's a hero iframe or result card iframe
                const iframe = card.querySelector('.result-card-embed') || card.querySelector('.search-hero-iframe');
                if (!iframe) return;
                
                try {
                    // Try to access iframe content - if blocked, show fallback
                    const iframeDoc = iframe.contentDocument || iframe.contentWindow?.document;
                    if (!iframeDoc || (iframeDoc.body && iframeDoc.body.innerHTML.trim() === '')) {
                        // Iframe might be blocked - try alternative URL for Google
                        if (url && url.includes('google.com') && !url.includes('udm=2')) {
                            // Try alternative Google URL format
                            const altUrl = url + (url.includes('?') ? '&' : '?') + 'udm=2';
                            iframe.src = altUrl;
                            return;
                        }
                        // Show preview/fallback after delay
                        setTimeout(() => {
                            handleIframeError(cardId, url || '', title || '', '');
                        }, 1000);
                    }
                } catch (e) {
                    // Cross-origin error - this is expected for Google/YouTube
                    // Check if iframe actually rendered content by checking dimensions
                    setTimeout(() => {
                        if (iframe.offsetHeight < 50) {
                            // Iframe seems empty, show fallback
                            handleIframeError(cardId, url || '', title || '', '');
                        }
                    }, 2000);
                }
            }, 1000);
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function getEngineIcon(engine) {
            const icons = {
                chatgpt: '<img src="https://chat.openai.com/favicon.ico" alt="ChatGPT" style="width: 20px; height: 20px; border-radius: 4px;" onerror="this.style.display=\'none\'; this.nextElementSibling.style.display=\'inline\'"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: none;"><circle cx="12" cy="12" r="10"></circle><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></svg>',
                perplexity: '<img src="https://www.perplexity.ai/favicon.ico" alt="Perplexity" style="width: 20px; height: 20px; border-radius: 4px;" onerror="this.style.display=\'none\'; this.nextElementSibling.style.display=\'inline\'"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: none;"><circle cx="12" cy="12" r="10"></circle><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></svg>',
                grok: '<img src="https://x.com/favicon.ico" alt="Grok" style="width: 20px; height: 20px; border-radius: 4px;" onerror="this.style.display=\'none\'; this.nextElementSibling.style.display=\'inline\'"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: none;"><circle cx="12" cy="12" r="10"></circle><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></svg>',
                google: '<img src="https://www.google.com/favicon.ico" alt="Google" style="width: 20px; height: 20px; border-radius: 4px;" onerror="this.style.display=\'none\'; this.nextElementSibling.style.display=\'inline\'"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: none;"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg>',
                bing: '<img src="https://www.bing.com/favicon.ico" alt="Bing" style="width: 20px; height: 20px; border-radius: 4px;" onerror="this.style.display=\'none\'; this.nextElementSibling.style.display=\'inline\'"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: none;"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg>',
                youtube: '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22.54 6.42a2.78 2.78 0 0 0-1.94-2C18.88 4 12 4 12 4s-6.88 0-8.6.46a2.78 2.78 0 0 0-1.94 2A29 29 0 0 0 1 11.75a29 29 0 0 0 .46 5.33A2.78 2.78 0 0 0 3.4 19c1.72.46 8.6.46 8.6.46s6.88 0 8.6-.46a2.78 2.78 0 0 0 1.94-2 29 29 0 0 0 .46-5.25 29 29 0 0 0-.46-5.33z"></path><polygon points="9.75 15.02 15.5 11.75 9.75 8.48 9.75 15.02"></polygon></svg>',
                brave: '<img src="https://search.brave.com/favicon.ico" alt="Brave" style="width: 20px; height: 20px; border-radius: 4px;" onerror="this.style.display=\'none\'; this.nextElementSibling.style.display=\'inline\'"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: none;"><path d="M12 2L2 7l10 5 10-5-10-5z"></path><path d="M2 17l10 5 10-5"></path><path d="M2 12l10 5 10-5"></path><circle cx="12" cy="12" r="3"></circle></svg>',
                wikipedia: '<img src="https://en.wikipedia.org/favicon.ico" alt="Wikipedia" style="width: 20px; height: 20px; border-radius: 4px;" onerror="this.style.display=\'none\'; this.nextElementSibling.style.display=\'inline\'"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: none;"><circle cx="12" cy="12" r="10"></circle><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path><path d="M8 12h8M12 8v8"></path></svg>',
                gemini: '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5z"></path><path d="M2 17l10 5 10-5"></path><path d="M2 12l10 5 10-5"></path></svg>',
                amazon: '<img src="https://www.amazon.com/favicon.ico" alt="Amazon" style="width: 20px; height: 20px; border-radius: 4px;" onerror="this.style.display=\'none\'; this.nextElementSibling.style.display=\'inline\'"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: none;"><circle cx="9" cy="21" r="1"></circle><circle cx="20" cy="21" r="1"></circle><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path></svg>',
                reddit: '<img src="https://www.reddit.com/favicon.ico" alt="Reddit" style="width: 20px; height: 20px; border-radius: 4px;" onerror="this.style.display=\'none\'; this.nextElementSibling.style.display=\'inline\'"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: none;"><circle cx="12" cy="12" r="10"></circle><circle cx="12" cy="12" r="3"></circle><path d="M12 1v6m0 6v6"></path></svg>',
                default: '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.35-4.35"></path></svg>'
            };
            return icons[engine] || icons.default;
        }

        // Set as Homepage
        function setAsHomepage() {
            const url = window.location.href;
            
            // Try different methods for different browsers
            if (window.external && ('setHomePage' in window.external)) {
                // IE/Edge
                try {
                    window.external.setHomePage(url);
                    alert('Homepage set successfully!');
                    trackHomepageAddition();
                    return;
                } catch (e) {
                    console.error('Failed to set homepage:', e);
                }
            }
            
            // Show instructions for other browsers
            const instructions = `
To set Vizoo as your homepage:

Chrome/Edge:
1. Click the three dots menu
2. Go to Settings
3. Click "On startup"
4. Select "Open a specific page"
5. Add this URL: ${url}

Firefox:
1. Click the menu button
2. Go to Settings
3. Under "Home" section, paste: ${url}

Safari:
1. Go to Safari > Preferences
2. Click "General"
3. Set homepage to: ${url}
            `;
            
            if (confirm(instructions + '\n\nClick OK to copy the URL to clipboard.')) {
                navigator.clipboard.writeText(url).then(() => {
                    alert('URL copied! Follow the instructions above to set it as your homepage.');
                    trackHomepageAddition();
                });
            }
        }

        // Track homepage additions via GitHub
        async function trackHomepageAddition() {
            try {
                // Increment local count
                let localCount = parseInt(localStorage.getItem('vizoo_homepage_count') || '0');
                localCount++;
                localStorage.setItem('vizoo_homepage_count', localCount.toString());
                localStorage.setItem('vizoo_homepage_timestamp', new Date().toISOString());
                
                // Try to update GitHub counter file
                await updateGitHubCounter(localCount);
                
                // Update display
                updateHomepageCount();
            } catch (error) {
                console.error('Error tracking homepage:', error);
                // Still update local count
                updateHomepageCount();
            }
        }

        // Update GitHub counter file using GitHub API
        async function updateGitHubCounter(newCount) {
            // GitHub API endpoint - replace with your repo details
            const repoOwner = 'vipulhharihar';
            const repoName = 'vizoo'; // or your actual repo name
            const filePath = 'counter.json';
            const branch = 'main';
            
            try {
                // First, get the current file to get its SHA
                const getFileUrl = `https://api.github.com/repos/${repoOwner}/${repoName}/contents/${filePath}`;
                const getResponse = await fetch(getFileUrl);
                
                if (getResponse.ok) {
                    const fileData = await getResponse.json();
                    const currentContent = JSON.parse(atob(fileData.content));
                    
                    // Update the count
                    const updatedContent = {
                        count: newCount,
                        lastUpdated: new Date().toISOString()
                    };
                    
                    // Update file via GitHub API
                    // Note: This requires authentication in production
                    // For now, we'll use a CORS proxy or you can set up GitHub Actions
                    const updateUrl = `https://api.github.com/repos/${repoOwner}/${repoName}/contents/${filePath}`;
                    
                    // This requires a GitHub token - for production, use a backend or GitHub Actions
                    // For demo, we'll just log it
                    console.log('Would update GitHub counter to:', newCount);
                    
                    // Alternative: Use a serverless function or GitHub Actions webhook
                    // For now, the count is stored locally and can be synced manually
                }
            } catch (error) {
                console.log('GitHub API update requires authentication. Using local storage.');
                // Fallback: Store in localStorage and sync later
            }
        }

        // Update homepage count display
        async function updateHomepageCount() {
            const countElement = document.getElementById('homepageCount');
            if (!countElement) return;
            
            try {
                let count = parseInt(localStorage.getItem('vizoo_homepage_count') || '0');
                
                // Try to fetch from GitHub repo
                try {
                    const repoOwner = 'vipulhharihar';
                    const repoName = 'vizoo'; // Update with your repo name
                    const response = await fetch(`https://raw.githubusercontent.com/${repoOwner}/${repoName}/main/counter.json?t=${Date.now()}`);
                    
                    if (response.ok) {
                        const data = await response.json();
                        count = data.count || count;
                    }
                } catch (e) {
                    // Use localStorage count if GitHub fetch fails
                }
                
                if (count > 0) {
                    countElement.innerHTML = `<svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: inline-block; vertical-align: middle; margin-right: 4px;"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path></svg>${count}`;
                } else {
                    countElement.innerHTML = '';
                }
            } catch (error) {
                countElement.textContent = '';
            }
        }

        // Hero carousel navigation
        let currentHeroIndex = 0;
        let totalHeroes = 0;

        function navigateHero(direction) {
            const container = document.getElementById('searchHeroContainer');
            const indicators = document.querySelectorAll('.search-hero-indicator');
            if (!container) return;

            totalHeroes = container.children.length;
            currentHeroIndex = (currentHeroIndex + direction + totalHeroes) % totalHeroes;
            
            container.style.transform = `translateX(-${currentHeroIndex * 100}%)`;
            
            indicators.forEach((ind, index) => {
                ind.classList.toggle('active', index === currentHeroIndex);
            });
        }

        function goToHero(index) {
            const container = document.getElementById('searchHeroContainer');
            const indicators = document.querySelectorAll('.search-hero-indicator');
            if (!container) return;

            currentHeroIndex = index;
            container.style.transform = `translateX(-${currentHeroIndex * 100}%)`;
            
            indicators.forEach((ind, i) => {
                ind.classList.toggle('active', i === currentHeroIndex);
            });
        }


        // Global functions
        window.selectRecommendation = selectRecommendation;
        window.handleIframeError = handleIframeError;
        window.checkIframeLoad = checkIframeLoad;
        window.openAIModal = openAIModal;
        window.navigateHero = navigateHero;
        window.goToHero = goToHero;


        // Set homepage button
        const setHomepageBtn = document.getElementById('setHomepageBtn');
        if (setHomepageBtn) {
            setHomepageBtn.addEventListener('click', setAsHomepage);
        }

        // Typing animation
        function typeText(element, text, speed = 50, callback) {
            if (!element) return;
            element.classList.add('typing');
            let i = 0;
            element.textContent = '';
            
            function type() {
                if (i < text.length) {
                    element.textContent = text.substring(0, i + 1);
                    element.classList.add('typing-text');
                    i++;
                    setTimeout(type, speed);
                } else {
                    setTimeout(() => {
                        element.classList.remove('typing-text');
                        if (callback) callback();
                    }, 500);
                }
            }
            type();
        }
        
        function startTypingAnimation() {
            const sentences = [
                'Search here, you are Home',
                'Vipul thinks unity of Open Searches',
                'We target to bring you home'
            ];
            
            let currentIndex = 0;
            const element = document.getElementById('typingText1');
            if (!element) return;
            
            function typeNext() {
                if (currentIndex >= sentences.length) {
                    currentIndex = 0; // Loop back to start
                }
                
                const text = sentences[currentIndex];
                typeText(element, text, 40, () => {
                    // Wait a bit before erasing
                    setTimeout(() => {
                        eraseText(element, () => {
                            currentIndex++;
                            // Wait before typing next sentence
                            setTimeout(typeNext, 300);
                        });
                    }, 2000);
                });
            }
            
            // Start typing after initial delay
            setTimeout(typeNext, 500);
        }
        
        function eraseText(element, callback) {
            let text = element.textContent;
            if (!text) {
                if (callback) callback();
                return;
            }
            
            function erase() {
                if (text.length > 0) {
                    text = text.substring(0, text.length - 1);
                    element.textContent = text;
                    element.classList.add('typing-text');
                    setTimeout(erase, 30);
                } else {
                    element.classList.remove('typing-text');
                    if (callback) callback();
                }
            }
            erase();
        }
        
        // Suppress iframe console errors
        const originalError = console.error;
        const originalWarn = console.warn;
        
        console.error = function(...args) {
            const message = args.join(' ');
            // Filter out known iframe-related errors
            if (
                message.includes('DOMNodeInserted') ||
                message.includes('DOMNodeRemoved') ||
                message.includes('autofocusing') ||
                message.includes('frame-ancestors') ||
                message.includes('Content Security Policy') ||
                message.includes('permissions policy') ||
                message.includes('service worker') ||
                message.includes('batchexecute') ||
                message.includes('Failed to load resource') && message.includes('google.com')
            ) {
                return; // Suppress these errors
            }
            originalError.apply(console, args);
        };
        
        console.warn = function(...args) {
            const message = args.join(' ');
            // Filter out known iframe-related warnings
            if (
                message.includes('DOMNodeInserted') ||
                message.includes('DOMNodeRemoved') ||
                message.includes('autofocusing') ||
                message.includes('permissions policy') ||
                message.includes('autoplay') ||
                message.includes('encrypted-media') ||
                message.includes('accelerometer') ||
                message.includes('gyroscope') ||
                message.includes('clipboard-write')
            ) {
                return; // Suppress these warnings
            }
            originalWarn.apply(console, args);
        };
        
        // Initialize
        initAIModal();
        updateRecommendationsPanel();
        updateHomepageCount();
        startBackgroundSlideshow();
        startTypingAnimation();
        searchInput.focus();
    </script>
</body>
</html>
